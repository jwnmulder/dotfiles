#!/bin/bash

yadm_bin=~/.local/bin/yadm
[ ! -f $yadm_bin ] && yadm_bin=yadm

#cd "$HOME"
#$yadm_bin submodule update --recursive --init

# sparse checkout
$yadm_bin gitconfig core.sparseCheckout true
#$yadm_bin sparse-checkout set '/*' '!README.md'

cat << EOF > "$HOME/.local/share/yadm/repo.git/info/sparse-checkout"
# generated by $0
/*
!README.md
EOF

# yadm reset as otherwise 'yadm status' will show a lot of deleted files
$yadm_bin reset

# yadm checkout to activate the sparseCheckout config above
$yadm_bin checkout --quiet
